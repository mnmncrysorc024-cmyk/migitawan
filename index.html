<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>ミギタワン</title>
</head>
<body>
  <h1>ミギタワン</h1>
  <p>残り口数：<span id="stock">100</span></p>

  <button onclick="draw()">引く</button>
  <button onclick="resetOripa()">リセット</button>

  <div class="result" id="result">---</div>

  <h3>排出履歴</h3>
  <ul id="history"></ul>

  <script>
    let stock = 100;

    const prizes = [
      { name: "ウデンタモツ（SSR）", weight: 3 },
      { name: "ソルト（SR）", weight: 15 },
      { name: "たける（R）", weight: 30 },
      { name: "なおひろ（N）", weight: 50 }
    ];

    function drawPrize() {
      const total = prizes.reduce((sum, p) => sum + p.weight, 0);
      let rand = Math.random() * total;
      for (const prize of prizes) {
        if (rand < prize.weight) return prize.name;
        rand -= prize.weight;
      }
    }

    function draw() {
      if (stock <= 0) {
        alert("完売しました！");
        return;
      }
      stock--;
      document.getElementById("stock").textContent = stock;

      const result = drawPrize();
      document.getElementById("result").textContent = result;

      const li = document.createElement("li");
      li.textContent = result;
      document.getElementById("history").prepend(li);
    }

    function resetOripa() {
      stock = 100;
      document.getElementById("stock").textContent = stock;
      document.getElementById("result").textContent = "---";
      document.getElementById("history").innerHTML = "";
      alert("リセットしました");
    }
  </script>
</body>
</html>
